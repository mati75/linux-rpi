commit 8002eaa9a8b11b4d7d5899314a4e72dbe45cc42e
Author: Phil Elwell <phil@raspberrypi.org>
Date:   Fri Mar 13 12:43:36 2015 +0000

    Protect __release_resource against resources without parents
    
    Without this patch, removing a device tree overlay can crash here.
    
    Signed-off-by: Phil Elwell <phil@raspberrypi.org>

diff --git a/kernel/resource.c b/kernel/resource.c
index 2af6c03858b9..863f59d2dba9 100644
--- a/kernel/resource.c
+++ b/kernel/resource.c
@@ -246,6 +246,12 @@ static int __release_resource(struct resource *old, bool release_child)
 {
 	struct resource *tmp, **p, *chd;
 
+	if (!old->parent) {
+		WARN(old->sibling, "sibling but no parent");
+		if (old->sibling)
+			return -EINVAL;
+		return 0;
+	}
 	p = &old->parent->child;
 	for (;;) {
 		tmp = *p;
diff -uN a/1.txt b/1.txt
--- a/dummy/rpi_1004_8002eaa9a8b11b4d7d5899314a4e72dbe45cc42e.txt	1970-01-01 00:00:00.000000000 +0000
+++ b/dummy/rpi_1004_8002eaa9a8b11b4d7d5899314a4e72dbe45cc42e.txt	2013-12-23 04:07:40.000000000 +0000
@@ -0,0 +1 @@
+dummy file to ensure patch has content.
